# 设置-更多-抓取

## 减慢抓取速度

<p class="option" data-no="75" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_减慢抓取速度的说明" data-tip="减慢抓取速度可以避免在抓取时被 Pixiv 临时限制（429状态码）。&lt;br&gt;这会增加抓取时间。">
    <span data-xztext="_减慢抓取速度"><span class="key">减慢</span>抓取速度</span>
    <span class="gray1"> ? </span>
    </span>
    <input type="checkbox" name="slowCrawl" class="need_beautify checkbox_switch" checked>
    <span class="beautify_switch" tabindex="0"></span>
    <span class="subOptionWrap" data-show="slowCrawl" style="display: inline-flex;">
    <span data-xztext="_当作品数量大于">当作品数量超过指定数量时启用：</span>
    <input type="text" name="slowCrawlOnWorksNumber" class="setinput_style1 blue" value="100">
    <span class="verticalSplit"></span>
    <span data-xztext="_间隔时间">间隔时间：</span>
    <input type="text" name="slowCrawlDealy" class="setinput_style1 blue" value="1600" placeholder="1600"> ms
    </span>
    </p>


减慢抓取速度可以避免在抓取时被 Pixiv 临时限制（429 错误）。但这会增加抓取时间。

如果用户启用了这个设置，那么下载器在抓取时的并发请求数量会变成 1。在每个请求完成之后，等待一定时间（取决于间隔时间的值）再发送下一个请求，以降低抓取频率，避免触发 429 限制。

?>这个设置只在抓取阶段生效，不会影响下载阶段。

**子选项：**

- `作品数量` 当要抓取的作品数量超过这个数字时（默认是 `100`），下载器才会使用慢速抓取模式。如果要抓取的作品数量较少，下载器依然会很快完成抓取。
- `间隔时间` 你可以设置一个请求完成后，等待多长时间再发送下一个请求。单位是毫秒，默认值是 `1600`。如果你经常触发 429 错误，可以增大这个值，例如设置为 `2000`。

**注意：**

这个选项并不能完全避免 429 错误。原因：

1. 它假设用户只在一个页面抓取，此时应该不会触发 429 错误。但如果用户在 2 个或 3 个页面里同时抓取，因为发送请求比较频繁，就依然可能会触发 429 错误。
2. 用户的一些正常操作也是会消耗额度的，例如打开作品页面、预览作品、收藏作品等，当额度用尽时就会触发 429 错误。所以在抓取时，如果用户进行了很多此类操作，也可能会导致触发 429 错误。

## 不抓取多图作品的最后一张图片

<p class="option" data-no="69" style="display: flex;">
    <span class="settingNameStyle1" data-xztext="_不抓取多图作品的最后一张图片">不抓取多图作品的<span class="key">最后一张</span>图片</span>
    <input type="checkbox" name="doNotDownloadLastImageOfMultiImageWork" class="need_beautify checkbox_switch">
    <span class="beautify_switch" tabindex="0"></span>
    </p>

如果你启用了这个选项，下载器抓取时会跳过多图作品的最后一张图片。

例如，有些画师的多图作品的最后一张图片是 Fanbox 的宣传图，不需要下载，此时就可以启用这个选项。

## 用户阻止名单

<p class="option" data-no="35" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_用户阻止名单的说明" data-tip="不下载这些用户的作品。需要输入用户 id。&lt;br&gt;
    如果有多个用户 id，使用英文逗号,分割。">
    <span data-xztext="_用户阻止名单">用户<span class="key">阻止</span>名单</span>
    <span class="gray1"> ? </span>
    </span>
    <input type="checkbox" name="userBlockList" class="need_beautify checkbox_switch">
    <span class="beautify_switch" tabindex="0"></span>
    <span class="subOptionWrap" data-show="userBlockList" style="display: none;">
      <textarea class="centerPanelTextArea beautify_scrollbar" name="blockList" rows="1" placeholder="11111,22222,33333"></textarea>
      <br>
      <input type="checkbox" name="removeBlockedUsersWork" id="setRemoveBlockedUsersWork" class="need_beautify checkbox_common" checked="">
      <span class="beautify_checkbox" tabindex="0"></span>
      <label for="setRemoveBlockedUsersWork" data-xztext="_从页面上移除他们的作品" class="active">从页面上移除他们的作品</label>
      <button type="button" class="gray1 textButton" id="showRemoveBlockedUsersWorkTip" data-xztext="_提示">提示</button>
    </span>
    </p>

可以理解为黑名单。你可以输入想要屏蔽的用户的 ID，这样下载器就不会下载这些用户的作品。

?>注意：需要输入**用户 ID**（数字），而不是用户名。因为用户名不唯一。

?>如果要屏蔽多个用户，可以输入多个用户 id，中间使用英文逗号 `,` 分割。

此选项还有一个子选项：从页面上移除他们的作品。启用之后，下载器会在多种页面上查找被屏蔽的用户的作品，如果有就移除它们，这样你就不会看到不喜欢的用户的作品了。

当下载器移除了某些用户的作品时，会在顶部日志里显示详情，例如：

<span style="color: rgb(210, 126, 0);" class="log">移除了用户 <a href="https://www.pixiv.net/users/6756759" target="blank">村上水軍</a> 的作品<br></span>

?>在被阻止的用户的主页里不会移除他们的作品，以便让用户可以正常查看他们的主页。

## 针对特定用户屏蔽标签

<div class="option" data-no="39" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_针对特定用户屏蔽tag的提示" data-tip="例如，抓取用户 123456 的作品时，排除特定的标签。">
    <span data-xztext="_针对特定用户屏蔽tag">针对特定用户屏蔽<span class="key">标签</span></span>
    <span class="gray1"> ? </span>
    </span>
    <input type="checkbox" name="blockTagsForSpecificUser" class="need_beautify checkbox_switch">
    <span class="beautify_switch" tabindex="0"></span>
    <span class="subOptionWrap" data-show="blockTagsForSpecificUser" style="display: none;">
    <slot data-name="blockTagsForSpecificUser"><div class="blockTagsForSpecificUserWrap">
    <div class="controlBar">
      <span class="total">0</span>
      <button type="button" class="textButton expand" data-xztext="_收起">收起</button>
      <button type="button" class="textButton showAdd" data-xztext="_添加">添加</button>
    </div>
    <div class="addWrap">
      <div class="settingItem addInputWrap">
        <div class="inputItem uid">
          <span class="label uidLabel" data-xztext="_用户id">用户 ID（数字）</span>
          <input type="text" class="setinput_style1 blue addUidInput" data-xzplaceholder="_必须是数字" placeholder="必须是数字">
        </div>
        <div class="inputItem tags">
          <span class="label tagsLabel">Tags</span>
          <input type="text" class="setinput_style1 blue addTagsInput" data-xzplaceholder="_tag用逗号分割" placeholder="多个标签使用英文逗号,分割">
        </div>
      </div>
    </div>
    <div class="listWrap" style="display: block;"></div>
  </div></slot>
    </span>
    </div>

如果你不喜欢某个用户的某些作品，并且不想让下载器抓取和下载它们，就可以启用这个设置。

你可以输入用户 ID 和他作品里的一些标签。当下载器抓取这个用户的作品时，不会抓取含有这些标签的作品。

例如，你可以设置排除用户 ID `123456` 的 `标签1,标签2,标签3`。

## 定时抓取的间隔时间

<p class="option" data-no="74" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_定时抓取的间隔时间的说明" data-tip="在一些页面里有“定时抓取”按钮，即每隔一定时间，自动开始抓取和下载。&lt;br&gt;你可以在这里设置每次抓取的间隔时间。">
    <span data-xztext="_定时抓取的间隔时间"><span class="key">定时</span>抓取的间隔时间</span>
    <span class="gray1"> ? </span>
    </span>
    <input type="text" name="timedCrawlInterval" class="setinput_style1 blue" value="120">
    <span class="settingNameStyle1" data-xztext="_分钟">分钟</span>
    
    </p>

设置定时抓取的间隔时间。

在一些页面里有“定时抓取”按钮，点击之后可以让下载器每隔一段时间自动进行一次抓取和下载。你可以在这里设置每次抓取的间隔时间。

默认值是 120 分钟（2 小时）。

## 自动导出抓取结果

<p class="option" data-no="54" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_自动导出抓取结果的说明" data-tip="抓取完成后自动导出抓取结果。&lt;br&gt;可以使用两种格式：CSV 格式易于阅读，JSON 格式则可以用于导入抓取结果。">
    <span data-xztext="_自动导出抓取结果">自动<span class="key">导出</span>抓取结果</span>
    <span class="gray1"> ? </span>
    </span>
    <input type="checkbox" name="autoExportResult" class="need_beautify checkbox_switch">
    <span class="beautify_switch" tabindex="0"></span>
    <span class="subOptionWrap" data-show="autoExportResult" style="display: none;">
    <span data-xztext="_抓取结果">抓取结果</span>
    <span>&gt;</span>
    <input type="text" name="autoExportResultNumber" class="setinput_style1 blue" value="1" style="width:30px;min-width: 30px;">
    <span>&nbsp;</span>
    <span class="settingNameStyle1" data-xztext="_文件格式">文件格式</span>
    <input type="checkbox" name="autoExportResultCSV" id="autoExportResultCSV" class="need_beautify checkbox_common" checked="">
    <span class="beautify_checkbox" tabindex="0"></span>
    <label for="autoExportResultCSV" class="active"> CSV </label>
    <input type="checkbox" name="autoExportResultJSON" id="autoExportResultJSON" class="need_beautify checkbox_common" checked="">
    <span class="beautify_checkbox" tabindex="0"></span>
    <label for="autoExportResultJSON"> JSON </label>
    </span>
    </p>

启用此设置后，下载器在**抓取完成时**会自动导出抓取结果。

**子选项：**

- 抓取结果：当抓取结果的数量大于指定值时，才会导出抓取结果。
- 文件格式：你可以选择导出为 CSV 文件或（和）JSON 文件。CSV 格式易于阅读，JSON 格式则可以用于导入抓取结果。两种格式里的内容也有区别：JSON 里的内容是完整的，CSV 里的内容是依据 JSON 生成，并且只有部分数据，没有保存一些不常用的数据。

## 获取作品 ID 列表后导出 ID 列表，并停止任务

<p class="option" data-no="85" style="display: flex;">
    <span class="has_tip settingNameStyle1" data-xztip="_导出ID列表的说明" data-tip="此时只会运行抓取，不会开始下载。&lt;br&gt;并且会忽略大多数过滤条件。">
    <span data-xztext="_导出ID列表">获取作品 ID 列表后导出 <span class="key">ID 列表</span>，并停止任务</span>
    <span class="gray1"> ? </span>
    </span>
    <input type="checkbox" name="exportIDList" class="need_beautify checkbox_switch">
    <span class="beautify_switch" tabindex="0"></span>
    </p>

如果你想获取下载器抓取到的作品 ID 列表，并且不需要下载文件，就可以启用这个选项。

**导出时机：**

- 导出时机是在下载器获取了所有要抓取的作品 ID 之后。注意这不是“抓取完成后”，而是更早。

下载器的抓取阶段分为 2 个步骤：
1. 获取所有作品的 ID 列表。
2. 逐个获取作品的详细数据，检查过滤条件，保存符合条件的作品的数据。

导出时机是在步骤 1 之后，并且会停止任务，也就是不会执行步骤 2。

!> 由于导出时机比较早，此时没有应用过滤器，所以导出的作品 ID 里可能含有不符合过滤条件的作品。

**导出的内容：**

导出的作品 ID 列表会保存到一个 JSON 文件里。你可以自行处理该文件，不过从设计目的上，这是为了配合另一个功能使用的：首页的“导入 ID 列表”按钮。

导出的 JSON 文件是个对象数组，内容格式如下：

<pre>
[
  { "id": "130827095", "type": "illusts" },
  { "id": "130816057", "type": "illusts" },
  { "id": "130811075", "type": "novel" },
  { "id": "130808918", "type": "novel" }
]
</pre>

`id` 是作品的 ID，`type`  是作品类型，可能是 `"illusts"` 或 `"novel"`。

