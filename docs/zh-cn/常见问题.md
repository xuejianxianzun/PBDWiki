# 常见问题

?>你可以使用浏览器的搜索功能 `F3`，输入关键词在本页面上进行查找。

## 检查以下信息

当你遇到问题时，请首先检查下面的原因：

1. 如果浏览器不是 Chrome 或者 Edge，请使用 Chrome 浏览器或者 Edge 浏览器。
2. 如果你的浏览器不是最新版本，请更新浏览器。
3. 如果本扩展程序不是最新版本，请更新到最新版本。最新版本号：![version](https://img.shields.io/github/v/release/xuejianxianzun/PixivBatchDownloader)
4. 可能是网络连接不畅，请检查网络连接。国内用户建议使用梯子，并且使用全局代理模式。如果你是 nginx 反代理上 p 站的，换成梯子。
5. 系统磁盘的剩余空间可能不足。请尝试清理系统磁盘空间，然后重新启动浏览器，继续未完成的下载。

## 检查其他原因

1. 如果你不清楚某些功能怎么使用，请参考本 wiki 里的相关内容。
2. 查看 [安装之后的设置](zh-cn/安装之后) 页面，检查一些原因。
3. 查看本页面上的帮助信息。
4. 如果问题仍然不能解决，请查看 [联系我](zh-cn/联系我) 页面。

-------------

## 怎么建立文件夹

在命名规则里使用斜线 `/` ，斜线前面的部分会作为文件夹的名字。

如 `{p_title}/{id}-{tags}-{user}` 会使用页面标题建立一个文件夹。

## 怎么把画师的作品放到同一个文件夹里

怎么把画师的作品放在一起？

在命名规则里使用画师名字作为文件夹名字就可以了。例如：

```
{user}/{id}
```

## 文件下载到了哪里

文件/图片保存位置：下载的文件保存在浏览器的下载目录里。

## 能不能把文件保存到浏览器下载目录之外

不能，这是浏览器的限制。

下载器自动保存文件时，只能把文件保存到浏览器的下载目录里，这是浏览器的安全策略。

## 怎么修改下载位置

如果你不想让文件保存到浏览器的下载目录里，那么你只能在浏览器的设置中，修改下载文件夹的位置。

浏览器设置-高级-下载内容-位置

`chrome://settings/downloads`

此外还有一个变通的方法。你可以通过设置命名规则，把文件存放到下载目录里的一个子目录里。在下载完成后，你可以把这个子目录里的内容移动到其他位置。

例如： `pixiv/{user}/{id}`

## 为什么抓取到的文件数量比作品数量多

有时候在抓取完成后你可能会看到像这样的提示：

```
共有 10 个作品
共有 20 个文件
```

这是因为有些作品可能包含多个图片。每个图片是一个文件，所以文件数量比作品数量多是很正常的。

## 下载后的文件名乱码

*文件名异常/文件名乱码/uuid*

有些用户可能看到下载后的文件名是一串不知道什么意思的字符，类似这样：

![](./images/20211112162142.jpg)

```
7dc64752-0616-448d-99ce-4676c501b503.png
e3852d43-4a9f-4156-abda-544eff38ce3f.jpg
```

这是因为其他扩展程序修改了下载器的文件的名字，导致了这个问题。

你可以尝试依次禁用其他有**下载功能**的扩展程序。然后使用本扩展程序，观察问题是否解决。通过这种方法来找到有冲突的扩展程序。

冲突的扩展程序通常是管理文件下载的，例如 Chrono 下载管理器，或者是一些下载软件的扩展程序（如 IDM 的浏览器扩展），或者是具有下载视频、下载图片、截图等功能的扩展程序。

一些**已知的**会导致冲突的扩展程序：参见“安装之后”页面的“留意有冲突的扩展程序”部分。

*从技术上来看，如果一个扩展程序在代码中使用了 `onDeterminingFilename` 事件，就有可能与下载器产生冲突。*

*下载器没有使用这个事件，也不会影响其他扩展程序的文件名。*

## 是否支持断点续传

支持断点续传。下载时如果页面崩溃或者关闭了页面，之后可以打开这个页面继续下载。

## 怎么不下载重复文件

怎么不下载以前已经下载过的作品？

启用选项“不下载重复文件”。可查看  [不下载重复文件](/zh-cn/设置-其他?id=不下载重复文件) 部分。

在某些情况下，你也可以考虑使用增量更新，避免下载以前下载过的文件。可查看“使用技巧”页面的“增量更新”部分。

## 下载很慢

下载慢、下载没速度怎么办？

这主要是国内用户会遇到的问题，推荐使用靠谱的代理/翻墙软件，比如 ssr、v2ray、clash 等，使用稳定的路线。并且代理规则选择**全局代理**。（**开启全局代理可以提高下载速度**）

还有另一个办法，就是用“复制 url”功能复制图片网址，使用迅雷、IDM 等软件下载。但是这些软件下载时无法对文件重命名。

## 动图下载很慢

动图下载慢首先请参考上一条。另外动图下载慢有时候也是正常的。

1. 动图的体积本身就很大，下载会慢一些、
2. pixiv 动图的本质是 zip 文件。如果选择了动图保存格式为“webm”或者“APNG”或者“gif”，那么下载器还会对 zip 文件进行转码，这也会花费一些时间。
3. 可能是页面被遮挡住了。请参考：[转换动图时保持页面不被完全遮挡](/zh-cn/使用技巧?id=转换动图时保持页面不被完全遮挡)

## 任务卡住怎么办

这一般是网络问题，网络情况越差，越容易遇到这个问题。

如果你在抓取任务时就卡住，可以尝试等待一段时间，看过一段时间之后是否能够继续抓取。如果不能，建议刷新页面重新抓取。

如果在下载时卡住，可以先暂停任务然后点击开始下载；或者关闭页面，之后再打开这个页面，继续下载。

?>如果你的网络情况比较差，可以把下载线程设置的小一些，减小卡住的几率。

## 下载卡住时会自动重试吗

会。

当网络状况较差时，下载可能会因为超时或者网络断开而卡住。本程序会自动重试下载出错的文件。

## 一直卡住，无法下载到任何图片

首先检查网络问题，如果网络没问题（可以正常访问 Pixiv，网速也很快），那么你可以检查一下系统盘（一般是 C 盘）剩余空间。

如果系统盘剩余空间比较小，Chrome 可能会阻止一些较大的 xhr 请求，导致下载一直失败。请清理一下空间再尝试下载。这个原因是由 Reinford 找出来的。

*备注：在这种情况下，Chrome 不会阻止 fetch 请求*

## 下载到的图片是损坏的

下载的图片只能显示一部分/一半，剩余部分没有图像。

这可能是下载时网络出现问题，图片加载到一半之后失败了。请重新下载损坏的图片/作品。

如果重新下载后还是损坏的，可能是这个图片存在缓存。请清除浏览器的缓存之后，刷新页面重新下载这个作品。

## 下载进度条变成红色是怎么回事

这表示这个进度条上的文件下载出现了错误，下载器会尝试重新下载它。

你不需要做出处理。

## 下载失败：USER_CANCELED

如果出现这样的错误提示，注意有没有出现另存为对话框。如果有，参考下一条。如果没有，请查看“联系我”页面，报告问题。

## 下载时弹出另存为对话框

请确认你在浏览器设置里**关闭**了“下载前询问每个文件的保存位置”。

如果关闭了这个选项，仍然会出现另存为对话框，原因是下载的文件里有重复的文件名。如果带 `{id}` 标记应该不会重名，其他时候记得带序号。比如作品 id 78279423，有三张图片，`{id}` 标记会带序号，这样就不会重名：

```
78279423_p0.jpg
78279423_p1.jpg
78279423_p2.jpg
```

如果不带序号，就会重名：

```
78279423.jpg
78279423.jpg
78279423.jpg
```

当命名规则里没有 `{id}` 或者 `{p_num}`，则要留意是否会出现重名问题。

## 为什么在搜索页面不会自动开始下载

你可以关闭“预览搜索页面的筛选结果”，并且启用“自动开始下载”，这样就可以自动开始下载了。

为什么启用了“预览搜索页面的筛选结果”就不会自动开始下载了呢？请查看这个选项的说明。

[预览搜索页面的筛选结果](zh-cn/设置-其他?id=预览搜索页面的筛选结果)

## 离线安装之后，浏览器启动时会出现提示

如果你离线安装了本程序，当浏览器启动时，可能会在右上角提示：请停止以开发者模式运行的扩展程序。

![](./images/2019-10-18_17-12-00.jpg)

>Chrome 84 版本之后没有这个弹窗了。但是 Edge 浏览器目前还有。

如果你想消除这个提示，以下提供一些办法：

1. 如果你安装有火绒杀毒软件，你可以使用它的屏蔽弹窗功能，屏蔽这个弹窗。

![](./images/2019-10-18_17-17-00.png)

注意只选择这个弹窗，不要把整个 chrome 都屏蔽了。

来源：[一届书生](https://www.cnblogs.com/52dxer/p/11067617.html ':target=_blank')

*在线安装本扩展不会出现弹窗警告。*

## Date format error!

如果启用了选项“设置投稿时间”，需要输入起始时间和结束时间。

如果输入的时间不能被解析为有效的时间，就会出现警告信息：`Date format error!`

## 无权访问某个作品

这是因为在获取某个作品时出现了无法处理的错误。

这是一个网络请求的错误，可能这个作品是私密的作品，或者只是单纯的网络问题。

你可以打开这个 id 的作品页面，如果它是正常的，你可以在这个页面直接下载它。

## 下载（抓取）按钮不显示

这可能是某些设置项的值有误，导致下载器出错。

你可以尝试打开下载面板-“其他”选项卡-管理设置-重置设置，然后刷新页面。

## 如何下载 ID 列表

如果你有作品的 id 列表，想根据 id 列表进行下载，需要打开 Pixiv 主页，然后打开下载器面板，可以看到这个按钮：

*输入id进行抓取*

点击这个按钮会出现一个输入框，把 id 列表复制进去就可以开始抓取了。

## 怎么停止抓取

怎么停止/中止/中断抓取？

目前没有控制按钮可以停止抓取。你可以刷新页面来强制停止抓取。

## 浏览器启动时卡住

Chrome很卡/卡顿/Chrome启动无响应/卡一会儿/浏览器卡顿/浏览器很卡

这可能是你的下载记录太多导致的。你可以在“清理浏览数据”界面查看下载记录的数量：

![](./images/20211112175156.png)

下载记录太多可能会导致浏览器卡顿，特别是浏览器刚启动时，以及打开下载管理页面时。

一般来说，如果下载记录的数量超过 10,000 个，你就可以清理了。

如果清理下载记录之后，问题依然没有解决，请考虑卸载和重装浏览器。

## 怎么分批下载

分批下载/分批抓取

在一些页数较多的页面里，如果你预计到抓取结果太多，可以考虑分批进行抓取和下载。

例如：

1. 在第 1 页，设置“抓取页数”为 100，然后开始抓取和下载。
2. 下载完成后，跳转到第 101 页，然后再次抓取 100 页。因为下载器会从当前页面开始计算页数，所以这样可以抓取 101 - 200 页。
3. 以此类推。

## 怎么让下载的文件按照网页上的顺序排序

*图片排序，作品排序，文件排序*

怎么让下载的作品保持和网页上一样的顺序呢？

在大部分页面里，作品都是按照作品 id 倒序排序的。越晚发表的作品，其 id 越大。

你在网页上看的作品排序可能是这样的：

```
96954935
96894692
96800281
96659987
96628297
```

下载器默认的命名规则会在文件名的开头使用 `{id}`。你可以让下载后的文件按照文件名排序，也就是使用作品 id 来排序。

不过资源管理器里的默认排序是正序排列的（从小到大），所以你看到的文件的顺序和网页上是相反的。如果你想让文件的顺序和网页上的一致，你可以在资源管理器里更改排序方式，让文件名倒序排列。

## 下载收藏的作品时怎么让文件按照收藏顺序排序

下载书签里的作品时，怎么让下载的文件和作品的收藏顺序一致？

之所以会有这个问题，是因为收藏/书签里的作品的排序不是按照作品 id 排序的，而是按照你收藏它的时间来排序的。

默认的，你最新收藏的作品会排在前面，最早收藏的作品会排在后面。怎么让下载后的文件按照收藏的顺序排列呢？

你可以修改命名规则，在文件名的开头使用 `{bmk_id}`，例如 `{bmk_id}-{id}`。

- `{bmk_id}` Bookmark Id。你收藏的每一个作品都会有一个 Bookmark Id。收藏的时间越晚，Bookmark Id 就越大。当你下载你的收藏时，可以使用 `{bmk_id}` 作为排序依据。

`{bmk_id}` 是一串数字，但它不是作品 id，而是你收藏这个作品时产生的一个数字。在文件名的开头使用这个数字，可以用来对文件进行排序。

不过资源管理器里的默认排序是正序排列的（从小到大），所以你看到的文件的顺序和网页上是相反的。如果你想让文件的顺序和网页上的一致，你可以在资源管理器里更改排序方式，让文件名倒序排列。

## 搜索标签时最多只能抓取 1000 页怎么办

搜索页面不能抓取所有作品怎么办？目前没有能够直接解决这个的办法，需要你多花点时间来手动解决。

有些 tag 的搜索结果很多，例如：

https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks

“背景” tag 现在有 172,734 个作品。一页显示 60 个作品，总页数接近 2900 页。

但是你可能只能查看到 1000 页。当你位于第 1000 页时。底部的页码也到头了，没有后续的页码：

https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks?p=1000https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks?p=1000

![](./images/20220304162133.png)

抓取不完了，这是怎么回事呢？

1. 这是 pixiv 的限制，下载器无法破解。
2. pixiv 普通用户最多可以查看 1000 页，pixiv 高级会员最多可以查看 5000 页。
3. 你能够查看到多少页，下载器也就能下载到多少页。

**怎么解决这个问题**？以下是一些可行的方法：

- 方法 1：修改排序方式来抓取更多作品

![](./images/20220304162041.jpg)

默认情况下搜索结果的排序方式是从新到旧。你可以先正常抓取和下载 1000（或者 5000）页，下载完成之后，在第一页点击“按旧排序”，这样搜索结果的排序方式是从旧到新，这样你就能够下载到更多的作品了，最多可以下载到 2000（或者 10000）页的作品。但是如果这样还是不能下载到所有作品，那就需要考虑其他办法了。

- 方法 2：使用时间段筛选

你可以在搜索页面点击“搜索条件”，然后设置“时间”选项为“指定时间”。

![](./images/20220304162104.png)

例如，你可以设置时间范围为某一年，然后查看和下载这一年里发表的作品。

下载完成后，再搜索另一年里发表的作品，并下载它们。以此类推。

- 方法 3：购买 pixiv 高级会员（premium）

因为 pixiv 高级会员（premium）可以查看 5000 页，所以不容易遇到这个问题。相比之下，普通用户只能查看 1000 页，遇到这个问题的几率就比较高。

## 下载时发生错误，状态码为 0

有些用户可能会遇到下面的错误：

```
下载时发生错误，状态码为 0，请求未成功。可能的原因： 

1. 系统磁盘的剩余空间可能不足（建议剩余空间大于 4GB）。请尝试清理系统磁盘空间，然后重新启动浏览器，继续未完成的下载。 

2. 网络错误。可能是网络代理导致的问题。
```

这是因为对于下载器发出的请求，浏览器直接返回了 200 failed 状态（请求成功但返回了失败的结果。下载器内部 XHR 请求的 status 是 0）。

可能的原因以及解决方法：

1. 系统磁盘的剩余空间可能不足（建议剩余空间大于 4GB）。注意要看【系统盘】的剩余空间，而不是其他盘。如果系统盘的剩余空间小，就清理空间。
2. 网络错误。目前已知一些国内用户使用 Nginx 反代理上 p 站，或者 Apache 反代理上 p 站，有可能发生这个问题。请关闭这些反代理软件，换成使用梯子访问 p 站，就不会出现这个错误了。

## 怎么用梯子？

梯子就是俗称的翻墙软件。

目前小白很容易错误的购买一些收费的梯子（vpn）软件，但这些软件的大多是坑钱的，质量不佳。例如：蓝灯、蜂窝vpn、西部世界、猎豹加速器等。

在这些软件里，它的线路基本都是固定的一些线路，是软件开发商自己维护的。你不能换成别的机场的翻墙服务。如果这个软件自带的翻墙服务不好用，那你也没办法对它怎么样。

成熟的梯子是免费的，其软件只是一个工具，不自带翻墙功能。现在 Windows 上流行的软件是 V2rayN 和 Clash。手机上的话 Clash 似乎更方便一些。

有了梯子软件后，你需要去机场（提供翻墙服务的网站）购买翻墙服务，然后在梯子里使用。机场提供的线路不管是在数量上还是速度、稳定性上都比那些坑钱的软件更好。有些机场提供免费路线（免费的质量就差一些）。如果一个机场不好用了，你可以换成别的机场。

---------

下面是一个机场网站：

https://fxyjs.fun/#/register?code=LwvNxWre

你注册账号后，进入后台可以购买套餐。

购买套餐之后，就需要下载梯子软件并进行配置。这个网站里有使用文档，里面有梯子软件的下载链接和教程。选择 V2rayN 或者 Clash 都可以，我现在用的是 V2rayN。

--------

很多机场的套餐一般都分包月的（到期的话就过期）或者按流量的（购买一定额度的流量，不用完就不会过期）。

这就像一些点卡游戏的月卡或者点卡一样，需要你根据自己的需求来选择。

比如下面的一个月卡和一个点卡的对比：

```
[专业版]Pro 
¥ 29.90
月付
每月流量300G
```

```
[100G流量包]Package
¥ 25.00
100G流量包,用完为止,永不过期,可续费
```

它们的价格是差不多的，但是月卡有 300G 流量，点卡只有 100G 流量。

看起来差得很多，似乎月卡更好。但是对于一般用户来说，买点卡比较好。因为一般用户不会整天疯狂下载，所以你买 100G 流量也许能用好几个月，这样下来每个月才几块钱。

如果你购买月卡，一个月内没用完 300G 流量，过期就作废了，也就浪费了一部分钱。

所以如果你用的流量多，可以考虑月卡。用的流量少，就偏向于点卡。
